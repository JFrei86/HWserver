{% extends "Component.twig" %}

{% block component_click %}
    onClickComponent(this)
{% endblock %}

{% set extra_credit_points = component.upper_clamp - component.max_value %}
{% set penalty_points = 0-component.lower_clamp %}
{% block left_block %}
    {# TODO: badge and point value assignments (peer too?) #}
    {% if show_mark_list %}
        <div class="container point-values">
            <div class="row">
                <div class="col point-input-container">
                    <input class="max-points" step="{{ precision }}" type="number" min="0" value="{{ component.max_value|round(decimal_precision) }}" onclick="event.stopPropagation()"/>
                </div>
                <div class="col point-label">Normal Points</div>
            </div>
            <div class="row">
                <div class="col point-input-container">
                    <input class="extra-credit-points" step="{{ precision }}" type="number" min="0" value="{{ extra_credit_points|round(decimal_precision) }}" onclick="event.stopPropagation()"/>
                </div>
                <div class="col point-label">Extra Credit Points</div>
            </div>
            <div class="row">
                <div class="col point-input-container">
                    <input class="penalty-points" step="{{ precision }}" type="number" min="0" value="{{ component.lower_clamp|abs|round(decimal_precision) }}" onclick="event.stopPropagation()"/>
                </div>
                <div class="col point-label">Penalty Points</div>
            </div>
            <div class="row">
                <div class="col count-up-selector count-type-selector {{ component.default == 0 ? 'count-type-selected' : ''}}" onclick="onClickCountUp(this); event.stopPropagation()">
                    <span>Count Up</span>
                </div>
                <div class="col count-down-selector count-type-selector {{ component.default != 0 and component.default == component.max_value ? 'count-type-selected' : ''}}" onclick="onClickCountDown(this); event.stopPropagation()">
                    <span>Count Down</span>
                </div>
            </div>
            <div class="row">
            </div>
        </div>
    {% else %}
        <strong class="badge green-background">
            {{ component.max_value|round(decimal_precision) }} {{ extra_credit_points > 0 ? '(+' ~ extra_credit_points|round(decimal_precision) ~ ')' }} {{ penalty_points > 0 ? '(-' ~ penalty_points|round(decimal_precision) ~ ')' : '' }}
        </strong>
    {% endif %}
{% endblock %}

{% block right_block %}
    {% if not show_mark_list %}
        <span class="reorder-component-container" onclick="event.stopPropagation()">
            <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
        </span>
    {% endif %}
    <span class="col-no-gutters" onclick="onDeleteComponent(this); event.stopPropagation()">
        <i class="fa fa-trash" title="Delete this component"></i>
    </span>
{% endblock %}

{% block title_block %}
    {% if show_mark_list %}
        <div class="col component-title-container">
            <input class="component-title" type="text" value="{{ component.title }}" placeholder="Component Title" onclick="event.stopPropagation()"/>
        </div>
        {% if component.page > 0 %}
            <div class="col-no-gutters page-label">
                <span><i>Page #:</i></span>
            </div>
            <div class="col-no-gutters">
                <input class="page-number" type="number" step="1" min="1" value="{{ component.page }}" onclick="event.stopPropagation()"/>
            </div>
        {% else %}
            <input class="page-number" value="{{ component.page }}" hidden/>
        {% endif %}
    {% else %}

        <span class="component-title col-no-gutters">
            <b>{{ component.title }}</b>
        </span>

        {% if component.page > 0 %}
            <span class="page-number-view col">
                <i>Page #: {{ component.page }}</i>
            </span>
        {% endif %}
    {% endif %}
{% endblock %}

{% block ta_comment_block %}
    <textarea class="ta-comment" placeholder="Note to TAs" onclick="event.stopPropagation()">{{ component.ta_comment }}</textarea>
{% endblock %}

{% block student_comment_block %}
    <textarea class="student-comment" placeholder="Note to Student" onclick="event.stopPropagation()">{{ component.student_comment }}</textarea>
{% endblock %}

{% block marks_block %}
    {% set show_publish = true %}
    {% for mark in component.marks %}
        {% set first_mark = loop.index0 == 0 %}
        {% include "Mark.twig" %}
    {% endfor %}
{% endblock %}