{% import _self as self %}

{% for check in checks %}
    {% if loop.index0 != 0 %}
        <div class="clear"></div>
    {% endif %}
    {% if check.pdf %}
        <iframe src="{{ core.buildUrl({"component": "misc", "page": "display_file", "dir": "results", "file": check.name, "path": check.path}) }}" width="95%" height="1200px" style="border: 0"></iframe>
    {% else %}
        <div class="box-block">

            {% if check.actual %}
                {{ self.render_diff_element(check, check.actual, 0) }}
            {% endif %}
            {% if check.expected %}
                {{ self.render_diff_element(check, check.expected, 1) }}
            {% endif %}
            {% if check.difference %}
                {{ self.render_diff_element(check, check.difference, 2) }}
            {% endif %}

        </div>
    {% endif %}

{% endfor %}

{% macro render_diff_element(check, element, side) %}
    <!-- Readded css here so the popups have the css -->
    <div class='diff-element'>
        <h4>
            {{ element.title }}
            {% if element.show_popup %}
                <span onclick="openPopUp('{{ popup_css_file }}', '{{ element.title }}', {{ index }}, {{ loop.index0 }}, {{ side }});">
                    <i class="fa fa-window-restore" style="cursor: pointer;"></i>
                </span>
            {% endif %}
        </h4>

        <div id="container_{{ index }}_{{ loop.index0 }}_0">
            {% for message in check.messages %}
                {% set type_class = "black-message" %}
                {% if message['type'] == "information" %}
                    {% set type_class = "blue-message" %}
                {% elseif message['type'] == "success" %}
                    {% set type_class = "green-message" %}
                {% elseif message['type'] == "failure" %}
                    {% set type_class = "red-message" %}
                {% elseif message['type'] == "warning" %}
                    {% set type_class = "yellow-message" %}
                {% endif %}
                <span class="{{ type_class }}">{{ message['message'] }}</span><br />
            {% endfor %}
            {% if element.type == "image" %}
                <img src="{{ element.src }}" style="border:2px solid black">
            {% elseif element.type == "text" %}
                <div id=div_{{ index }}_{{ loop.index0 }}>
                    {{ element.src|raw }}
                </div>
            {% endif %}
        </div>
    </div>
{% endmacro %}
