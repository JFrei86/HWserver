{% extends 'generic/Popup.twig' %}
{% block popup_id %}category_wrapper{% endblock %}
{% block title %}Categories{% endblock %}
{% block body %}
    <i>For no filter, unselect all categories</i><br/>
    <center>
        <select id="thread_category" name="thread_category" class="form-control" multiple size="10" style="height: auto;">
            {% for category in categories %}
                <option value="{{ category.category_id }}" style="color: {{ category.color }}">{{ category.category_desc }}</option>
            {% endfor %}
        </select>
    </center>

    <script type="text/javascript">
        function updateThreads() {
            {% if thread_exists %}
            modifyThreadList({{ current_thread }}, '{{ current_category_ids|join("|") }}', '{{ current_course }}');
            {% endif %}
        }
        $( document ).ready(function() {
            $('#thread_category option').mousedown(function(e) {
                e.preventDefault();
                var current_selection = $(this).prop('selected');
                $(this).prop('selected', !current_selection);
                updateThreads();
                return true;
            });
            {% for category in cookie_selected_categories %}
            $('#thread_category option[value="{{ category }}"]').prop('selected', true);
            {% endfor %}

            $("#tree").prop("checked", true);
            {% if display_option in ['tree', 'time', 'alpha'] %}
            $("#{{ display_option }}").prop("checked", true);
            {% endif %}
        });
    </script>
{% endblock %}
{% block form %}
    <form method="post" action="{{ core.buildUrl({'page': 'change_username'}) }}">
        {{ parent() }}
    </form>
{% endblock %}
{% block buttons %}
    <a class="btn btn-default" title="Clear Filter" onclick="$('#thread_category option').prop('selected', false);updateThreads();$('#category_wrapper').css('display', 'none');"><i class="fa fa-eraser"></i> Clear Filter</a>
    <a class="btn btn-default" title="Close Popup" onclick="$('#category_wrapper').css('display', 'none');"><i class="fa fa-times"> Close</i></a>
{% endblock %}
