{% if viewer.isGrader() %}
  <table class="table table-striped" style="width:100%;" id="current_queue">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Name</th>
        <th scope="col">Status</th>
        <th scope="col">Time</th>
        <th scope="col">Remove</th>
        <th scope="col">Queue</th>
        <th scope="col" class="mobile-hide">ID</th>
      </tr>
    </thead>
    <tbody>
      {% for entry in viewer.getCurrentQueue() %}
        <tr class="row_color_{{viewer.getIndexFromCode(entry['queue_code'])}} queue_current_{{viewer.cleanForId(entry['queue_code'])}} current_queue_row" style="display:none;">
          <th scope="row" class="row_number">{{entry['row_number'] }}</th>
          <td>{{ entry['name'] }}</td>

          {% if entry['current_state'] == 'waiting' %}
            <td>
              <form method="post" action="{{base_url}}/{{entry['queue_code']}}/startHelp">
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}"/>
                <input type="hidden" name="user_id" value="{{entry['user_id']}}"/>
                <input type="hidden" name="queue_code" value="{{ entry['queue_code'] }}"/>
                {% if viewer.firstTimeInQueue(entry['user_id'], entry['queue_code']) %}
                  <input type="submit" value="Help" class="btn btn-success">
                {% else %}
                  <input type="submit" value="Help" class="btn btn-primary">
                {% endif %}
              </form>
            </td>
          {% elseif entry['current_state'] == 'being_helped' %}
            <td>
              <form method="post" action="{{base_url}}/{{entry['queue_code']}}/finishHelp">
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}"/>
                <input type="hidden" name="user_id" value="{{entry['user_id']}}"/>
                <input type="hidden" name="queue_code" value="{{ entry['queue_code'] }}"/>
                {% if entry['help_started_by'] == viewer.getUserId() %}
                  <input type="submit" value="Finish Helping" class="btn btn-success">
                {% else %}
                  <input type="submit" value="Finish Helping" class="btn btn-primary">
                {% endif %}
              </form>
            </td>
          {% endif %}

          {% if entry['current_state'] == 'being_helped' %}
            <td class="help_timer" help_time="{{ viewer.timeToISO(entry['time_help_start']) }}"></td>
          {% else %}
            <td>{{ viewer.timeToHM(entry['time_in']) }}</td>
          {% endif %}

          <td>
            <form method="post" action="{{base_url}}/{{entry['queue_code']}}/remove" onsubmit="return confirm('Are you sure you want to remove {{ entry['name'] }} from the queue?');">
              <input type="hidden" name="csrf_token" value="{{ csrf_token }}"/>
              <input type="hidden" name="user_id" value="{{entry['user_id']}}"/>
              <input type="hidden" name="queue_code" value="{{ entry['queue_code'] }}"/>
              <input type="submit" value="Remove" class="btn btn-default">
            </form>
          </td>
          <td>{{ entry['queue_code'] }}</td>
          <td class="mobile-hide">
            <a class="post-user-info" onclick="unhideId(this, '{{ entry['user_id'] }}')" title="Show user id" aria-label="Show user id">
              <i class="fas fa-eye"></i>
            </a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr id="queue_empty_msg" style="display:none">
        <td colspan="100">
          Your queue is currently empty. Make sure you have the correct filter settings set.
        </td>
      </tr>
    </tfoot>
  </table>
{% endif %}
